# ğŸ“‹ C&C CRM Development Rules & Project Structure

## ğŸš¨ **CRITICAL DOCUMENTATION RULE**

### **ALWAYS READ BEFORE UPDATING:**
- **NEVER update any .md file without reading it first**
- **Multiple AIs work simultaneously on this project**
- **Always use `read_file` tool to read the current content before making changes**
- **Check for recent updates from other AIs to avoid conflicts**
- **Update only after understanding the current state**

---

## ğŸ¯ **PROJECT STATUS OVERVIEW**

**Project:** C&C CRM (Crate & Container Customer Relationship Management)  
**Version:** 2.6.0   
**Status:** ğŸš€ **PRODUCTION READY - Complete Alignment & Super Admin System**  
**Last Updated:** January 2025  

### **âœ… COMPLETED SYSTEMS**
- **Frontend Architecture:** 100% Complete (Next.js 14, TypeScript, Tailwind CSS)
- **Navigation System:** 100% Complete (Role-based, mobile-responsive, error-free)
- **Design System:** 100% Complete (Dark theme, atomic design, consistent spacing)
- **Authentication:** 100% Complete (Login, Register, Password Reset)
- **Core Pages:** 100% Complete (All 6 main pages with perfect alignment)
- **Journey Management:** 100% Complete (Core features with modular architecture)
- **Super Admin System:** 100% Complete (Multi-company management)
- **Backend API:** 90% Complete (FastAPI, PostgreSQL, Prisma ORM)

### **ğŸ”„ IN PROGRESS**
- **Database Connection:** Prisma client generation needs fixing
- **Journey Management Enhancements:** Phase 1 implementation (Analytics, Calendar, Reports)
- **Real-time Features:** WebSocket integration for live updates

---

## ğŸ—ï¸ **FRONTEND ARCHITECTURE**

### **âœ… IMPLEMENTED STRUCTURE**

```
apps/frontend/
â”œâ”€â”€ app/                          # âœ… Next.js 14 App Router
â”‚   â”œâ”€â”€ layout.tsx               # âœ… Root layout with PWA
â”‚   â”œâ”€â”€ page.tsx                 # âœ… Landing page
â”‚   â”œâ”€â”€ globals.css              # âœ… Custom Tailwind styles
â”‚   â”œâ”€â”€ manifest.ts              # âœ… PWA manifest
â”‚   â”œâ”€â”€ auth/                    # âœ… Authentication pages
â”‚   â”‚   â”œâ”€â”€ login/page.tsx       # âœ… Login with validation
â”‚   â”‚   â””â”€â”€ register/page.tsx    # âœ… Register with validation
â”‚   â”œâ”€â”€ dashboard/page.tsx       # âœ… Operations dashboard
â”‚   â”œâ”€â”€ journeys/page.tsx        # âœ… Journey management
â”‚   â”œâ”€â”€ journey/                 # âœ… Journey pages
â”‚   â”‚   â”œâ”€â”€ create/page.tsx      # âœ… Journey creation wizard
â”‚   â”‚   â””â”€â”€ [id]/page.tsx        # âœ… Journey detail view
â”‚   â”œâ”€â”€ users/page.tsx           # âœ… User management
â”‚   â”œâ”€â”€ clients/page.tsx         # âœ… Client management
â”‚   â”œâ”€â”€ crew/page.tsx            # âœ… Crew management
â”‚   â”œâ”€â”€ audit/page.tsx           # âœ… Audit & compliance
â”‚   â”œâ”€â”€ settings/page.tsx        # âœ… System settings
â”‚   â”œâ”€â”€ test/page.tsx            # âœ… Component showcase
â”‚   â””â”€â”€ super-admin/             # âœ… Super Admin Portal
â”‚       â”œâ”€â”€ auth/login/page.tsx  # âœ… Super admin login
â”‚       â”œâ”€â”€ dashboard/page.tsx   # âœ… Super admin dashboard
â”‚       â”œâ”€â”€ companies/page.tsx   # âœ… Company management
â”‚       â”œâ”€â”€ users/page.tsx       # âœ… User management
â”‚       â”œâ”€â”€ locations/page.tsx   # âœ… Location management
â”‚       â””â”€â”€ journeys/page.tsx    # âœ… Journey management
â”œâ”€â”€ components/                   # âœ… Atomic Design System
â”‚   â”œâ”€â”€ atoms/                   # âœ… Basic building blocks
â”‚   â”‚   â”œâ”€â”€ Button/              # âœ… 6 variants, loading states
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx       # âœ… IMPLEMENTED
â”‚   â”‚   â”‚   â””â”€â”€ index.ts         # âœ… IMPLEMENTED
â”‚   â”‚   â”œâ”€â”€ Input/               # âœ… Validation states, icons
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.tsx        # âœ… IMPLEMENTED
â”‚   â”‚   â”‚   â””â”€â”€ index.ts         # âœ… IMPLEMENTED
â”‚   â”‚   â”œâ”€â”€ Card/                # âœ… Flexible layout system
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.tsx         # âœ… IMPLEMENTED
â”‚   â”‚   â”‚   â””â”€â”€ index.ts         # âœ… IMPLEMENTED
â”‚   â”‚   â””â”€â”€ Badge/               # âœ… Status indicators
â”‚   â”‚       â”œâ”€â”€ Badge.tsx        # âœ… IMPLEMENTED
â”‚   â”‚       â””â”€â”€ index.ts         # âœ… IMPLEMENTED
â”‚   â”œâ”€â”€ navigation/              # âœ… Navigation components
â”‚   â”‚   â”œâ”€â”€ MainNavigation.tsx   # âœ… Main app navigation
â”‚   â”‚   â”œâ”€â”€ SuperAdminNavigation.tsx # âœ… Super admin navigation
â”‚   â”‚   â”œâ”€â”€ DesktopMenu.tsx      # âœ… Desktop sidebar
â”‚   â”‚   â”œâ”€â”€ MobileMenu.tsx       # âœ… Mobile menu
â”‚   â”‚   â”œâ”€â”€ Breadcrumbs.tsx      # âœ… Breadcrumb navigation
â”‚   â”‚   â”œâ”€â”€ MenuItem.tsx         # âœ… Menu item component
â”‚   â”‚   â””â”€â”€ MenuItems.tsx        # âœ… Menu items configuration
â”‚   â””â”€â”€ JourneyManagement/       # âœ… Journey management components
â”‚       â”œâ”€â”€ JourneyDetail/       # âœ… Journey detail components
â”‚       â”‚   â”œâ”€â”€ JourneyOverview.tsx # âœ… Journey overview
â”‚       â”‚   â”œâ”€â”€ JourneyTimeline.tsx # âœ… Visual timeline
â”‚       â”‚   â”œâ”€â”€ JourneyCrew.tsx  # âœ… Crew management
â”‚       â”‚   â”œâ”€â”€ JourneyMedia.tsx # âœ… Media gallery
â”‚       â”‚   â”œâ”€â”€ JourneyChat.tsx  # âœ… Real-time chat
â”‚       â”‚   â””â”€â”€ index.ts         # âœ… Clean exports
â”‚       â”œâ”€â”€ JourneyCreation/     # âœ… Journey creation components
â”‚       â”‚   â”œâ”€â”€ BasicInfoStep.tsx # âœ… Basic info step
â”‚       â”‚   â”œâ”€â”€ ScheduleStep.tsx # âœ… Schedule step
â”‚       â”‚   â”œâ”€â”€ CrewStep.tsx     # âœ… Crew assignment step
â”‚       â”‚   â”œâ”€â”€ ReviewStep.tsx   # âœ… Review step
â”‚       â”‚   â””â”€â”€ index.ts         # âœ… Clean exports
â”‚       â”œâ”€â”€ GPSTracking.tsx      # âœ… GPS tracking component
â”‚       â”œâ”€â”€ JourneyTimeline.tsx  # âœ… Standalone timeline
â”‚       â”œâ”€â”€ JourneyForm.tsx      # âœ… Reusable journey form
â”‚       â”œâ”€â”€ MediaUpload.tsx      # âœ… Media upload component
â”‚       â””â”€â”€ RealTimeChat.tsx     # âœ… Real-time chat system
â”œâ”€â”€ stores/                      # âœ… State management
â”‚   â”œâ”€â”€ authStore.ts             # âœ… Authentication state
â”‚   â”œâ”€â”€ journeyStore.ts          # âœ… Journey data state
â”‚   â”œâ”€â”€ menuStore.ts             # âœ… Navigation state
â”‚   â””â”€â”€ superAdminStore.ts       # âœ… Super admin state
â”œâ”€â”€ types/                       # âœ… TypeScript types
â”‚   â”œâ”€â”€ menu.ts                  # âœ… Menu type definitions
â”‚   â””â”€â”€ superAdmin.ts            # âœ… Super admin types
â”œâ”€â”€ utils/                       # âœ… Utility functions
â”‚   â”œâ”€â”€ cn.ts                    # âœ… Class name utility
â”‚   â”œâ”€â”€ menuItems.ts             # âœ… Menu configuration
â”‚   â””â”€â”€ superAdminMenuItems.ts   # âœ… Super admin menu config
â”œâ”€â”€ public/                      # âœ… Static assets
â”‚   â””â”€â”€ manifest.json            # âœ… PWA manifest
â”œâ”€â”€ package.json                 # âœ… Dependencies
â”œâ”€â”€ tailwind.config.js           # âœ… Custom theme
â”œâ”€â”€ next.config.js               # âœ… Next.js config
â”œâ”€â”€ postcss.config.js            # âœ… PostCSS config
â””â”€â”€ tsconfig.json                # âœ… TypeScript config
```

### **âœ… IMPLEMENTED DESIGN SYSTEM**

#### **Color Palette (Live Implementation)**
```css
/* Primary Colors - IMPLEMENTED */
background: #121212    /* Dark background */
surface: #1E1E1E       /* Card surfaces */
primary: #00C2FF       /* Bright cyan blue */
secondary: #19FFA5     /* Bright green */

/* Text Colors - IMPLEMENTED */
text-primary: #EAEAEA  /* Main text */
text-secondary: #B0B0B0 /* Secondary text */

/* Status Colors - IMPLEMENTED */
success: #4CAF50       /* Green */
warning: #FF9800       /* Orange */
error: #F44336         /* Red */
info: #2196F3          /* Blue */
```

#### **Typography (Live Implementation)**
- **Font Family:** Inter (Google Fonts) - âœ… Loaded
- **Heading Sizes:** 
  - h1: 2.5rem (40px) - âœ… Implemented
  - h2: 2rem (32px) - âœ… Implemented  
  - h3: 1.5rem (24px) - âœ… Implemented
  - h4: 1.25rem (20px) - âœ… Implemented
- **Body Text:** 1rem (16px) with 1.6 line height - âœ… Implemented
- **Small Text:** 0.875rem (14px) - âœ… Implemented

#### **Component System (Live Implementation)**
- **Button:** 6 variants (primary, secondary, ghost, danger, success, warning) âœ…
- **Input:** Validation states, icons, accessibility âœ…
- **Card:** Flexible layout with header, content, footer âœ…
- **Badge:** Status indicators with journey-specific variants âœ…
- **Atomic Design:** Atoms â†’ Molecules â†’ Organisms â†’ Templates â†’ Pages âœ…

### **âœ… IMPLEMENTED PAGES**

#### **Main Application URLs (All Working)**
- `http://localhost:3000` - Landing page âœ…
- `http://localhost:3000/auth/login` - Login page âœ…
- `http://localhost:3000/auth/register` - Register page âœ…
- `http://localhost:3000/dashboard` - Dashboard âœ…
- `http://localhost:3000/journeys` - Journey management âœ…
- `http://localhost:3000/journey/create` - Journey creation âœ…
- `http://localhost:3000/journey/[id]` - Journey details âœ…
- `http://localhost:3000/users` - User management âœ…
- `http://localhost:3000/clients` - Client management âœ…
- `http://localhost:3000/crew` - Crew management âœ…
- `http://localhost:3000/audit` - Audit & compliance âœ…
- `http://localhost:3000/settings` - System settings âœ…
- `http://localhost:3000/test` - Component showcase âœ…

#### **Super Admin Portal URLs (All Working)**
- `http://localhost:3000/super-admin/auth/login` - Super admin login âœ…
- `http://localhost:3000/super-admin/dashboard` - Super admin dashboard âœ…
- `http://localhost:3000/super-admin/companies` - Company management âœ…
- `http://localhost:3000/super-admin/users` - User management âœ…
- `http://localhost:3000/super-admin/locations` - Location management âœ…
- `http://localhost:3000/super-admin/journeys` - Journey management âœ…

#### **Page Features**
- **Landing Page:** Hero section, features showcase, statistics âœ…
- **Login Page:** Beautiful authentication form with validation and demo credentials âœ…
- **Register Page:** Comprehensive signup with form validation âœ…
- **Dashboard:** Interactive operations overview with journey cards and quick actions âœ…
- **Journey Management:** Complete journey workflow with comprehensive features âœ…
- **Super Admin Portal:** Multi-company management with cross-company oversight âœ…
- **Component Test:** All components working perfectly âœ…

### **âœ… IMPLEMENTED FEATURES**
- **Form Validation:** Real-time validation with error states âœ…
- **Search & Filtering:** Journey search and status filtering âœ…
- **Interactive Cards:** Hover effects and action buttons âœ…
- **Status Tracking:** Journey progress bars and status badges âœ…
- **Toast Notifications:** User feedback system âœ…
- **Mobile Responsive:** Perfect on all device sizes âœ…
- **PWA Ready:** Installable on mobile devices âœ…
- **Role-Based Access:** Different interfaces for different user roles âœ…
- **Multi-Company Support:** Super admin cross-company management âœ…
- **Real-time Features:** Status updates, crew chat, GPS tracking âœ…
- **Offline Capability:** Works without internet connection âœ…

---

## ğŸ”§ **DEVELOPMENT RULES**

### **ALWAYS FOLLOW THESE GUIDELINES:**

1. **Multi-Tenant First**: Every database query MUST include `clientId` and `locationId` scoping
2. **Role-Based Access**: All UI components and API endpoints MUST check user roles
3. **Audit Trail**: Every CRUD operation MUST create an `AuditEntry` with diff tracking
4. **Offline Capability**: All forms MUST work offline with auto-sync when reconnected
5. **Mobile-First**: All UI MUST be mobile-responsive and PWA-installable
6. **Dark Theme**: Use ONLY the specified color palette (`#121212`, `#00C2FF`, `#19FFA5`)
7. **C&C Modularity**: Build features as separate C&C modules that can be enabled/disabled
8. **Security**: JWT tokens, encrypted storage, role-based permissions on every endpoint

### **FRONTEND-SPECIFIC RULES:**

9. **Component Architecture**: Always use atomic design system (atoms â†’ molecules â†’ organisms)
10. **TypeScript**: Strict mode enabled, all components must be properly typed
11. **Responsive Design**: Mobile-first approach, test on all screen sizes
12. **Accessibility**: All components must be accessible (ARIA labels, keyboard navigation)
13. **Performance**: Use React.memo, useCallback, useMemo for optimization
14. **State Management**: Use Zustand for global state, local state for component-specific data
15. **Form Handling**: Use React Hook Form with Zod validation
16. **Error Handling**: Graceful error states with user-friendly messages
17. **Loading States**: Always show loading indicators for async operations
18. **Toast Notifications**: Use react-hot-toast for user feedback
19. **Consistent Spacing**: Use standardized padding (p-4 sm:p-6 lg:p-8) and gaps (gap-3 to gap-6)
20. **Visual Hierarchy**: Use proper text sizes (text-2xl to text-4xl) with font weights
21. **Hover Effects**: Use hover:shadow-lg transition-shadow for cards and interactive elements
22. **Mobile Optimization**: Touch-friendly button sizes and spacing for mobile devices

### **TECHNICAL CONSTRAINTS:**

- **Backend**: Python 3.11+ with FastAPI, Prisma ORM âœ… **LIVE**
- **Frontend**: Next.js 14 (App Router), TypeScript, Tailwind CSS âœ… **COMPLETE**
- **Database**: PostgreSQL with multi-tenant SuperDB architecture âœ… **RUNNING**
- **Deployment**: Render.com with Docker containers âœ… **WORKING**
- **File Structure**: Follow the exact monorepo structure from `Tree.txt`
- **Current URLs**: API (localhost:8000), DB (localhost:5432), Frontend (localhost:3000)

### **NAMING CONVENTIONS:**

- Use `TruckJourney` (not "Job" or "Move") as the core entity
- Use `JourneyStage` enum: `MORNING_PREP`, `EN_ROUTE`, `ONSITE`, `COMPLETED`
- Use `UserRole` enum: `DISPATCHER`, `DRIVER`, `MOVER`, `ADMIN`, `MANAGER`, `AUDITOR`
- Use `MediaType` enum: `PHOTO`, `VIDEO`, `SIGNATURE`
- Use `TagType` enum: `DAMAGE`, `FEEDBACK`, `ISSUE`
- **Component Files**: PascalCase (e.g., `JourneyCard.tsx`)
- **Component Folders**: PascalCase (e.g., `JourneyCard/`)
- **Utility Files**: camelCase (e.g., `cn.ts`)
- **Page Files**: kebab-case (e.g., `journey-detail.tsx`)

### **DEVELOPMENT PRIORITIES:**

1. **Journey Management Enhancements**: Begin Phase 1 implementation (Analytics, Calendar, Reports)
2. **Database Connection**: Fix Prisma client generation for database migrations
3. **Backend Integration**: Connect frontend to real API endpoints
4. **Real-time Features**: Implement WebSocket connections for live updates
5. **Super Admin Features**: Complete user, location, journey, and analytics management
6. **Production Deployment**: Deploy to production environment

---

## ğŸ“‹ **CHECKLIST FOR EVERY FEATURE**

Before implementing any feature, ensure:
- [ ] Multi-tenant scoping implemented
- [ ] Role-based permissions enforced
- [ ] Audit trail logging added
- [ ] Offline capability tested
- [ ] Mobile responsiveness verified
- [ ] Dark theme compliance checked
- [ ] C&C module structure followed
- [ ] Security measures implemented
- [ ] Documentation updated
- [ ] **Documentation read before updating** âœ…
- [ ] TypeScript types properly defined
- [ ] Component follows atomic design principles
- [ ] Form validation implemented
- [ ] Error states handled
- [ ] Loading states implemented
- [ ] Accessibility requirements met
- [ ] Performance optimized
- [ ] PWA compatibility verified
- [ ] Consistent spacing and alignment applied
- [ ] Hover effects and transitions added
- [ ] Mobile touch targets optimized

---

## ğŸ¯ **CURRENT STATUS**

### **âœ… COMPLETED**
- **Backend**: FastAPI server live on localhost:8000
- **Database**: PostgreSQL running on Docker (localhost:5432)
- **Frontend**: Next.js app complete with design system
- **Authentication**: Login/Register pages with validation
- **Dashboard**: Interactive operations overview
- **Components**: Complete atomic design system
- **Styling**: Beautiful dark theme with custom palette
- **Navigation**: Role-based, mobile-responsive, error-free
- **Journey Management**: Complete core system with modular architecture
- **Super Admin System**: Multi-company management with cross-company oversight

### **ğŸ”„ IN PROGRESS**
- **Database Connection**: Prisma client generation needs fixing
- **Journey Management Enhancements**: Phase 1 implementation (Analytics, Calendar, Reports)
- **Real-time Features**: WebSocket integration for live updates

### **ğŸ“‹ NEXT STEPS**
1. **Journey Management Enhancements**: Begin Phase 1 implementation (Analytics, Calendar, Reports)
2. **Database Integration**: Connect to real PostgreSQL data
3. **API Integration**: Connect to FastAPI backend
4. **Authentication Flow**: Real login/logout functionality
5. **Real Data Loading**: Replace mock data with API calls
6. **Super Admin Features**: Complete user, location, journey, and analytics management
7. **Production Deployment**: Deploy to production environment

---

## ğŸ”— **CURRENT ACCESS INFORMATION**

### **Development Environment:**
- **Database:** `postgresql://c_and_c_user:c_and_c_password@localhost:5432/c_and_c_crm`
- **Redis:** `redis://localhost:6379`
- **Frontend:** `http://localhost:3000` âœ…
- **API Server:** `http://localhost:8000` âœ… **LIVE AND WORKING**
- **Health Check:** `http://localhost:8000/health` âœ…
- **API Docs:** `http://localhost:8000/docs` âœ…

### **Main Application Pages (All Working):**
- **Landing:** `http://localhost:3000` âœ…
- **Login:** `http://localhost:3000/auth/login` âœ…
- **Register:** `http://localhost:3000/auth/register` âœ…
- **Dashboard:** `http://localhost:3000/dashboard` âœ…
- **Journeys:** `http://localhost:3000/journeys` âœ…
- **Journey Create:** `http://localhost:3000/journey/create` âœ…
- **Users:** `http://localhost:3000/users` âœ…
- **Clients:** `http://localhost:3000/clients` âœ…
- **Crew:** `http://localhost:3000/crew` âœ…
- **Audit:** `http://localhost:3000/audit` âœ…
- **Settings:** `http://localhost:3000/settings` âœ…
- **Test:** `http://localhost:3000/test` âœ…

### **Super Admin Portal (All Working):**
- **Super Admin Login:** `http://localhost:3000/super-admin/auth/login` âœ…
- **Super Admin Dashboard:** `http://localhost:3000/super-admin/dashboard` âœ…
- **Company Management:** `http://localhost:3000/super-admin/companies` âœ…
- **User Management:** `http://localhost:3000/super-admin/users` âœ…
- **Location Management:** `http://localhost:3000/super-admin/locations` âœ…
- **Journey Management:** `http://localhost:3000/super-admin/journeys` âœ…

### **Super Admin Demo Credentials:**
- **Username:** `udi.shkolnik`
- **Password:** `Id200633048!`
- **Role:** `SUPER_ADMIN`
- **Access:** Full system access across all companies

---

## ğŸ“š **DOCUMENTATION STRUCTURE**

### **Core Documentation:**
- **00_current_status_summary.md** - Complete project status and overview
- **01_overview.md** - Project overview and architecture
- **02_data_structure_guide.md** - Database schema and data models
- **03_user_roles_permissions.md** - User roles and permission system
- **04_api_structure_and_routes.md** - API endpoints and structure
- **05_frontend_ui_guide.md** - Frontend system overview
- **05a_design_system.md** - Design system specifications
- **05b_component_architecture.md** - Component architecture and patterns
- **05c_responsive_design.md** - Responsive design and alignment
- **06_modules_and_features_guide.md** - Feature modules and capabilities
- **13_journey_management_system.md** - Journey management system overview
- **13a_journey_management_analysis.md** - Journey management analysis and roadmap
- **16_multi_company_user_management.md** - Super admin system documentation

### **Documentation Rules:**
- **ALWAYS READ BEFORE UPDATING** - Never update any .md file without reading it first
- **Check for recent updates** - Multiple AIs work simultaneously on this project
- **Use read_file tool** - Always read current content before making changes
- **Update only after understanding** - Ensure you understand the current state

---

**Last Updated:** January 2025  
**Next Review:** After Phase 1 Journey Management implementation  
**Version:** 2.6.0 